apiVersion: argoproj.io/v1alpha1
kind: Application
metadata: 
  name: myapp-argo-application
  namespace: argocd 
spec: 
  project: default

  source: # the repo that hosts the app and the changes that might occure
    repoURL: https://github.com/Onsarouri/crud-app.git
    targetRevision: HEAD #last commits in my repo
    path: helm/myapp-docker

  destination: #kube cluster
    server: https://kubernetes.default.svc #the ArgoCD is deployed on the same cluster
    namespace: myapps 

  syncPolicy: 
    syncOptions:
    - CreateNamespace=ture 

  # Enabling atuomatic sync,
    automated: 
      selfHeal: true #Enabling automatic self-healing, by default chnages made to the live cluster will not trigger automated sync
      prune: true # Enabling automatic pruning (by default automatic sync will not delete resources)

  #ArgoCD polls Git repo every 3 mints, we can configure a Git webhook

---

apiVersion: v1 
kind: Secret
metadata:
  name: my-git-secret
  namespace: argocd
stringData:
  username: Onsarouri
  password: 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

